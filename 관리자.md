# 관리자 페이지 구축 가이드

## 📊 현재 프로젝트 상태 분석

### ✅ 이미 갖춰진 기술 스택
- **Next.js 15** - 프론트엔드/백엔드 프레임워크
- **Prisma ORM** - 데이터베이스 관리
- **NextAuth.js** - 로그인/인증 시스템
- **SQLite** - 데이터베이스 (개발용)
- **Framer Motion** - 애니메이션
- **Tailwind CSS** - 스타일링

### ✅ 이미 설계된 데이터베이스 스키마
```prisma
User {
  role: ADMIN | USER  // 관리자 구분 가능
}

Property {
  // 매물의 모든 정보 필드가 완벽하게 설계됨
  - 기본 정보 (제목, 설명, 위치)
  - 가격 정보 (분양가, 평단가, 권리금)
  - 투자 정보 (수익률, 투자등급)
  - 단지 정보 (세대수, 주차, 시설)
}

PropertyImage {
  // 이미지 관리 시스템 완비
}

Developer {
  // 건설사 정보
}
```

---

## 🎯 왜 1.5일(12-13시간)이 필요한가?

### 실제 작업 시간 분해

#### 1단계: NextAuth 인증 설정 (2시간)
**왜 필요한가?**
- 관리자만 접근할 수 있도록 로그인 시스템 필요
- 일반 사용자와 관리자를 구분해야 함

**실제 작업:**
```
1. `/api/auth/[...nextauth]/route.ts` 파일 생성 (30분)
   - 이메일/비밀번호 로그인 설정
   - 관리자 권한 체크 로직

2. `/admin/login/page.tsx` 로그인 페이지 (1시간)
   - 로그인 폼 UI
   - 에러 처리
   - 로그인 성공 시 리다이렉트

3. 미들웨어 설정 (30분)
   - `/admin/*` 경로 보호
   - 비로그인 시 로그인 페이지로 이동
```

#### 2단계: 관리자 레이아웃 (2시간)
**왜 필요한가?**
- 모든 관리자 페이지에서 공통으로 사용할 사이드바, 헤더 필요

**실제 작업:**
```
1. `/admin/layout.tsx` 생성 (1시간)
   - 사이드바 네비게이션
   - 상단 헤더 (로그아웃 버튼)

2. 대시보드 페이지 `/admin/page.tsx` (1시간)
   - 통계 표시 (총 매물 수, 문의 수 등)
   - 최근 활동 목록
```

#### 3단계: 매물 목록 페이지 (2시간)
**왜 필요한가?**
- 등록된 모든 매물을 보고 관리해야 함

**실제 작업:**
```
1. `/admin/properties/page.tsx` (1.5시간)
   - 테이블 형태로 매물 목록 표시
   - 검색 기능 (제목, 위치)
   - 필터 (상태, 건물타입)
   - 정렬 (가격, 날짜)
   - 수정/삭제 버튼

2. API `/api/admin/properties/route.ts` GET (30분)
   - Prisma로 DB에서 매물 조회
   - 검색/필터/정렬 로직
```

#### 4단계: 매물 등록 페이지 (3시간)
**왜 필요한가?**
- 관리자가 새 매물을 등록할 수 있어야 함

**실제 작업:**
```
1. `/admin/properties/new/page.tsx` (2시간)
   - 긴 폼 작성 (20개 이상의 필드)
     * 기본 정보: 제목, 위치, 건설사
     * 가격 정보: 분양가, 평단가, 권리금
     * 단지 정보: 세대수, 주차, 입주일
     * 투자 정보: 수익률, 등급
   - 폼 유효성 검사
   - 여러 이미지 업로드 UI

2. API `/api/admin/properties/route.ts` POST (1시간)
   - 폼 데이터 받기
   - Prisma로 DB에 저장
   - 이미지 파일 처리
   - 에러 처리
```

#### 5단계: 매물 수정 페이지 (2시간)
**실제 작업:**
```
1. `/admin/properties/[id]/edit/page.tsx` (1.5시간)
   - 기존 데이터 불러와서 폼에 표시
   - 등록 페이지와 유사하지만 수정용

2. API `/api/admin/properties/[id]/route.ts` PUT (30분)
   - 기존 데이터 업데이트
```

#### 6단계: 이미지 업로드 시스템 (2시간)
**왜 오래 걸리나?**
- 파일 업로드는 복잡함

**실제 작업:**
```
1. 이미지 저장 방식 선택 및 설정 (1시간)
   Option A: 로컬 저장 (public/uploads/)
   Option B: Cloudinary 같은 클라우드

2. 업로드 컴포넌트 제작 (1시간)
   - 드래그앤드롭
   - 미리보기
   - 여러 장 업로드
   - 삭제 기능
```

#### 7단계: 프론트엔드 DB 연동 (1시간)
**실제 작업:**
```
1. `/properties/page.tsx` 수정 (30분)
   - mockData 제거
   - API 호출로 실제 DB 데이터 가져오기

2. `/properties/[id]/page.tsx` 수정 (30분)
   - mockData 제거
   - params.id로 해당 매물 조회
```

---

## 💡 시간이 오래 걸리는 이유 요약

### 1. **폼이 매우 복잡함**
매물 하나를 등록하려면 입력해야 할 정보가 많습니다:
- 기본 정보 (제목, 설명, 위치, 주소 등) - 6개 필드
- 가격 정보 (분양가, 평단가, 권리금, 중도금 등) - 5개 필드
- 단지 정보 (세대수, 동수, 주차, 시설 등) - 8개 필드
- 투자 정보 (수익률, 등급, 위험도 등) - 5개 필드
- 이미지 (최소 5-10장)

→ **총 20개 이상의 입력 필드** 를 처리해야 함

### 2. **파일 업로드가 복잡함**
- 여러 장의 이미지를 한 번에 업로드
- 이미지 미리보기
- 이미지 순서 변경
- 기존 이미지 삭제

→ 일반 텍스트 입력보다 훨씬 복잡

### 3. **보안 처리 필수**
- 로그인하지 않은 사람은 접근 불가
- 일반 사용자는 접근 불가 (ADMIN만)
- CSRF 공격 방어
- 파일 업로드 보안 (악성 파일 차단)

### 4. **에러 처리**
- 필수 필드 누락 시 에러 메시지
- 이미지 업로드 실패 시 처리
- 데이터베이스 저장 실패 시 처리
- 네트워크 오류 처리

---

## 🚀 더 빠르게 만드는 방법들

### 방법 1: 단계별로 나눠서 만들기 (추천)
```
1일차: 로그인 + 매물 목록만 (4시간)
2일차: 매물 등록 기능 (3시간)
3일차: 이미지 업로드 (2시간)
```

### 방법 2: 라이브러리 사용 (빠름)
**AdminJS** 설치하면 1-2시간 안에 기본 관리자 페이지 완성
```bash
npm install adminjs @adminjs/prisma
```
- 장점: 빠름
- 단점: 디자인 커스터마이징 어렵고, 외부 라이브러리 의존

### 방법 3: 개발용으로 Prisma Studio 사용
```bash
npx prisma studio
```
- 장점: **0분 만에 사용 가능**, 설치 필요 없음
- 단점: 보안 없음 (개발 중에만 사용)

---

## 📋 작업 우선순위

### 지금 당장 해야 할 것 (30분)
```
✅ 3개 매물 데이터 개별화
   - mockData를 3개로 분리
   - URL에 따라 다른 데이터 표시
   - 코드만 수정하면 끝
```

### 다음 단계 선택지

**Option A: 임시로 코드로 계속 관리 (현재 방식)**
- 매물 추가할 때마다 코드 수정
- 장점: 추가 작업 없음
- 단점: 불편함, 실수 가능성

**Option B: 개발용 Prisma Studio 사용**
```bash
npx prisma studio
```
- 브라우저에서 엑셀처럼 데이터 관리
- 장점: 즉시 사용 가능
- 단점: 직원들에게 공유 어려움

**Option C: 관리자 페이지 제작**
- 1.5일 작업
- 장점: 직원들이 직접 등록 가능
- 단점: 시간 소요

---

## 🎯 결정해야 할 것

1. **지금 당장**: mockData 3개로 분리 → 진행할까요?
2. **향후 계획**:
   - A) 계속 코드로 관리
   - B) Prisma Studio로 임시 관리
   - C) 관리자 페이지 제작 시작

어떤 방식으로 진행하시겠습니까?
